<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="UTF-8">
    <title>Elastic-job by dangdangdotcom</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="stylesheets/normalize.css" media="screen">
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-light.css" media="screen">
  </head>
  <body>
    <section class="page-header">
      <h1 class="project-name">Elastic-job</h1>
      <h2 class="project-tagline">Elastic-Job is a distributed scheduled job framework, based on Quartz and Curator.</h2>
      <a href="https://github.com/dangdangdotcom/elastic-job" class="btn">View on GitHub</a>
      <a href="https://github.com/dangdangdotcom/elastic-job/zipball/master" class="btn">Download .zip</a>
      <a href="https://github.com/dangdangdotcom/elastic-job/tarball/master" class="btn">Download .tar.gz</a>
    </section>

    <section class="main-content">
<h2>
<a class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>Job sharding strategy</h2>

<ul>
<li>
<p><strong>Built-in strategies</strong></p>

<ol>
<li>
	<p><strong>AverageAllocationJobShardingStrategy</strong></p>
	<p><strong>Qualified class name:</strong></p>
	<p>com.dangdang.ddframe.job.plugin.sharding.strategy.AverageAllocationJobShardingStrategy</p>
	<p><strong>Details:</strong></p>
	<p>Based on average allocation sharding strategy, this is default strategy.</p>
	<p>If sharding item can not divide exactly, the remainder will append to job server which ordered by IP addresses.</p>
	<p>Example:</p>
	<p>If there are 3 servers, sharding to 9 items, result is: 1=[0,1,2], 2=[3,4,5], 3=[6,7,8]</p>
	<p>If there are 3 servers, sharding to 8 items, result is: 1=[0,1,6], 2=[2,3,7], 3=[4,5]</p>
	<p>If there are 3 servers, sharding to 10 items, result is: 1=[0,1,2,9], 2=[3,4,5], 3=[6,7,8]</p>
</li>
<li>
	<p><strong>OdevitySortByNameJobShardingStrategy</strong></p>
	<p><strong>Qualified class name:</strong></p>
	<p>com.dangdang.ddframe.job.plugin.sharding.strategy.OdevitySortByNameJobShardingStrategy</p>
	<p><strong>Details:</strong></p>
	<p>Use odevity of job name's hash code to decide server IP addresses order by ascending or descending.</p>
	<p>If job name's hash code is odd, the orders of IP addresses are ascending.</p>
	<p>If job name's hash code is even, the order of IP addresses are descending.</p>
	<p>Used to assign different jobs allocate to different servers.</p>
	<p>The disadvantage of AverageAllocationJobShardingStrategy is if total sharding count less than job servers, some servers will always assigned items, and other servers idle. OdevitySortByNameJobShardingStrategy can use job names to re-assign job servers.</p>
	<p>Example: </p>
	<p>If there are 3 servers, sharding to 9 items, hash code of job name odd, result is: 1=[0], 2=[1], 3=[]</p>
	<p>If there are 3 servers, sharding to 9 items, hash code of job name even, result is: 3=[0], 2=[1], 1=[]</p>
</li>
<li>
	<p><strong>RotateServerByNameJobShardingStrategy</strong></p>
	<p><strong>Qualified class name:</strong></p>
	<p>com.dangdang.ddframe.job.plugin.sharding.strategy.RotateServerByNameJobShardingStrategy</p>
	<p><strong>Details:</strong></p>
	<p>Use offset of job name's hash code to assign server IP addresses rotatably.</p>
</li>
</ol>
</li>
<li>
<p><strong>Customize job sharding strategy</strong></p>

<p>Implements interface JobShardingStrategy and override method sharding, parameters are job server IP list and JobShardingStrategyOption, JobShardingStrategyOption includes job name, total sharding count and sharding item parameters. You can write your logic here.</p>
<p>Welcome contribute your code by plug-in, pull to package com.dangdang.ddframe.job.plugin.sharding.strategy</p>
</li>
<li>
<p><strong>Configure sharding strategy</strong></p>

<p>Same to configure with regular job properties, you can use spring namespace or JobConfiguration to configure property jobShardingStrategyClass, value is full qualified class name.</p>
</li>
      <footer class="site-footer">
        <span class="site-footer-owner"><a href="https://github.com/dangdangdotcom/elastic-job">Elastic-job</a> is maintained by <a href="https://github.com/dangdangdotcom">dangdangdotcom</a>.</span>
      </footer>

    </section>

            <script type="text/javascript">
            var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
            document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
          </script>
          <script type="text/javascript">
            try {
              var pageTracker = _gat._getTracker("elastic-job");
            pageTracker._trackPageview();
            } catch(err) {}
          </script>

  </body>
</html>
